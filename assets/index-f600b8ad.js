import{a as Z}from"./axios-55335edb.js";const S=Z.create({baseURL:"https://livejs-api.hexschool.io/api/livejs/v1/customer",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"}});let x="absinthe";function tt(){return S({url:`/${x}/products`,method:"GET"})}function et(n,a){return S({url:`/${x}/carts`,method:"POST",data:{data:{productId:n,quantity:a}}})}function nt(){return S({url:`/${x}/carts`,method:"GET"})}function at(n){return S({url:`/${x}/carts/${n}`,method:"DELETE"})}function rt(){return S({url:`/${x}/carts`,method:"DELETE"})}function lt({name:n,tel:a,email:l,address:o,payment:c}){return console.log({data:{data:{user:{name:n,tel:a,email:l,address:o,payment:c}}}}),S({url:`/${x}/orders`,method:"POST",data:{data:{user:{name:n,tel:a,email:l,address:o,payment:c}}}})}let u=document.createDocumentFragment();function dt(n,a){let l=document.createElement("div"),o=new Image,c=document.createElement("p");return l.classList.add("cardItem-title"),o.src=`${n}`,o.alt="圖片",c.textContent=`${a}`,u.appendChild(o),u.appendChild(c),l.appendChild(u),l}function ot(n){let a=document.createElement("td"),l=dt(n.images,n.title);return u.appendChild(l),a.appendChild(u),a}function ct(n){let a=document.createDocumentFragment(),l=document.createElement("td"),o=document.createElement("a"),c=it();return l.classList.add("discardBtn"),o.href="#",o.classList.add("material-icons","a-delbtn"),o.textContent="clear",o.setAttribute("data-delcartid",`${n}`),o.setAttribute("data-delbtn","delOneData"),a.appendChild(o),a.appendChild(c),l.appendChild(a),l}function it(){let n=document.createElement("button"),a=document.createElement("span");return n.classList.add("loadind-cart","spinner-border","text-dark"),n.role="status",a.classList.add("visually-hidden"),a.textContent="Loading...",u.appendChild(a),n.appendChild(u),n}function st(n){let a=document.createElement("tr"),l=ot(n.product),o=document.createElement("td"),c=document.createElement("td"),g=document.createElement("td"),p=ct(n.id);return a.classList.add("cartItem"),o.textContent=`NT$${n.product.price.toLocaleString()}`,c.textContent=n.quantity,g.textContent=`NT$${n.product.price.toLocaleString()}`,u.appendChild(l),u.appendChild(o),u.appendChild(c),u.appendChild(g),u.appendChild(p),a.appendChild(u),a}let h=document.createDocumentFragment();function ut(){let n=document.createElement("button"),a=document.createElement("span");return n.classList.add("loadind-btn","spinner-border","text-white","bg-dark"),n.role="status",a.classList.add("visually-hidden"),a.textContent="Loading...",h.appendChild(a),n.appendChild(h),n}function pt(n){let a=document.createElement("li"),l=document.createElement("h4"),o=document.createElement("h3"),c=document.createElement("del"),g=document.createElement("p"),p=document.createElement("a"),f=new Image,$=ut();return l.textContent="新品",l.classList.add("productType"),o.textContent=n.title,f.src=n.images,f.alt="圖片",p.href="",p.classList.add("addCardBtn"),p.setAttribute("data-addcartid",`${n.id}`),p.textContent="加入購物車",p.appendChild($),c.classList.add("originPrice"),c.textContent=`NT$ ${n.origin_price.toLocaleString()}`,g.classList.add("nowPrice"),g.textContent=`NT$ ${n.price.toLocaleString()}`,a.classList.add("productCard"),h.appendChild(l),h.appendChild(f),h.appendChild(p),h.appendChild(o),h.appendChild(c),h.appendChild(g),a.appendChild(h),a}(function(){let n=document.querySelector(".productWrap"),a=document.querySelector(".shoppingCart-table"),l=document.querySelector(".tbody"),o=document.querySelector(".productSelect"),c=document.querySelector(".final-total"),g=document.querySelector(".discardAllBtn"),p=document.querySelector("form"),f=document.querySelectorAll(".orderInfo-input"),$=document.querySelectorAll(".orderInfo-message"),M=document.querySelector(".orderInfo-btn"),C=document.createDocumentFragment(),I=document.querySelector(".show-cart-table"),B=document.querySelector(".show-no-cart");document.querySelector(".modal-body");let v=[],D=[],w=[],A=[],m=[],b=[],E=[],y=!0,i=!0;function P(t,e){t.forEach(function(r){let d=pt(r);C.appendChild(d)}),e.appendChild(C)}function F(t){t.forEach(function(e,r){e!=null?D[r].style.display="block":D[r].style.display="none"})}function q(t){t?A.forEach(function(e){e.classList.remove("add-loading")}):A.forEach(function(e){e.classList.add("add-loading")})}function k(t,e){let r=a.getElementsByTagName("tr").length-1,d=a.getElementsByTagName("tr")[r];t.forEach(function(s){let Y=st(s);C.appendChild(Y)}),e.insertBefore(C,d)}function R(){let t=a.getElementsByTagName("tr").length-1,e=a.getElementsByTagName("tr")[0],r=a.getElementsByTagName("tr")[t];for(;l.firstChild;)l.removeChild(l.firstChild);C.appendChild(e),C.appendChild(r),l.appendChild(C)}function N(t){t.length===0?(I.style.display="none",B.style.display="block"):(I.style.display="block",B.style.display="none")}function T(){R(),k(m,l),N(m),b=Array.from(document.querySelectorAll(".loadind-cart")),E=Array.from(document.querySelectorAll(".a-delbtn"))}function G(t){w[t].style.display="block"}function _(t){w[t].style.display="none"}function U(t){b[t].style.display="block",E[t].style.display="none"}function L(t){t?E.forEach(function(e){e.classList.remove("del-loading")}):E.forEach(function(e){e.classList.add("del-loading")})}function V(){b.forEach(function(t){t.style.display="block"}),E.forEach(function(t){t.style.display="none"})}function z(t){let e={},r=m.find(function(d){return d.product.id===t});return r?(e.id=t,e.quantity=r.quantity+1):(e.id=t,e.quantity=1),e}function Q(t,e){return e.map(function(d,s){if(d.category===`${t}`)return s})}function W(t){return v.findIndex(function(r){return r.id===t})}function j(t){return m.findIndex(function(r){return r.id===t})}n.addEventListener("click",async function(t){t.preventDefault();let e=t.target.getAttribute("data-addcartid");if(t.target.getAttribute("class")==="addCardBtn"&&y){let r=W(e),d=z(e);y=!1,G(r),q(y);try{let s=await et(d.id,d.quantity);m=s.data.carts,y=!0,T(),_(r),q(y),swal({icon:"success",title:"商品已加入購物車!!"}),c.textContent=`NT$ ${s.data.finalTotal.toLocaleString()}`}catch(s){s.response.data.status||swal({icon:"error",title:`${s.response.data.message}`}),y=!0,_(r),q(y)}}}),o.addEventListener("change",function(t){let e=t.target.value;if(t.target.value==="全部")D.forEach(function(r){r.style.display="block"});else{let r=Q(e,v);F(r)}}),a.addEventListener("click",async function(t){t.preventDefault();let e=t.target.getAttribute("data-delcartid");if(t.target.getAttribute("data-delBtn")==="delOneData"&&i){i=!1,U(j(e)),L(i);try{let d=await at(e);m=d.data.carts,i=!0,T(),L(i),swal({icon:"success",title:"已將商品移除"}),c.textContent=`NT$ ${d.data.finalTotal.toLocaleString()}`}catch{error.response.data.status||swal({icon:"error",title:`${error.response.data.message}`}),i=!0,L(i)}}}),g.addEventListener("click",async function(t){t.preventDefault(),i=!1,L(i);try{V();let e=await rt();m=e.data.carts,i=!0,T(),L(i),swal({icon:"error",title:"已將商品全部移除"}),c.textContent=`NT$ ${e.data.finalTotal.toLocaleString()}`}catch{error.response.data.status||swal({icon:"error",title:`${error.response.data.message}`}),i=!0,L(i)}});async function H(){O();try{let t=await tt(),e=await nt();v=t.data.products,m=e.data.carts,P(v,n),k(m,l),N(m),D=Array.from(document.querySelectorAll(".productCard")),w=Array.from(document.querySelectorAll(".loadind-btn")),b=Array.from(document.querySelectorAll(".loadind-cart")),E=document.querySelectorAll(".a-delbtn"),A=document.querySelectorAll(".addCardBtn"),c.textContent=`NT$ ${e.data.finalTotal.toLocaleString()}`}catch(t){t.response.data.status||swal({icon:"error",title:`${t.response.data.message}`})}}H();let J={姓名:{presence:{message:"必填"}},電話:{presence:{message:"必填"}},Email:{presence:{message:"必填"},email:{message:"須符合Email格式"}},寄送地址:{presence:{message:"必填"}}};M.addEventListener("click",async function(t){t.preventDefault();const e=validate(p,J);if(e){let d=K(e);X(d);return}O();let r={name:f[0].value,tel:f[1].value,email:f[2].value,address:f[3].value,payment:f[4].value};try{(await lt(r)).status&&(m=[],T(),swal({icon:"success",title:"訂單已成立"}),p.reset(),c.textContent="NT$ 0")}catch(d){d.response.data.status||swal({title:"傳送失敗",text:`${d.response.data.message}`,icon:"error"})}});function O(){$.forEach(function(t){t.textContent=""})}function K(t){let e=[],r={姓名:0,電話:1,Email:2,寄送地址:3};return Object.entries(t).forEach(function(d){let s=[];s.push(r[d[0]]),s.push(d[1][0].replace(d[0],"")),e.push(s)}),e}function X(t){for(let e=0;e<t.length;e++)$[t[e][0]].style.display="block",$[t[e][0]].textContent=t[e][1].trim()}})();
